
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Overview/">
      
      
        <link rel="next" href="../Interpreters/Async%20Behavior%20Interpreter/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.8">
    
    
      
        <title>Preprocessor - StateForward</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.4b4a2bd9.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#stateforward.state_machine.preprocessor" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="StateForward" class="md-header__button md-logo" aria-label="StateForward" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            StateForward
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Preprocessor
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="StateForward" class="md-nav__button md-logo" aria-label="StateForward" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    StateForward
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Roadmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roadmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_3_1" id="__nav_2_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Core
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_1">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Core/Decorators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decorators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Core/Elements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Elements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Core/Functional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3_2" >
        
          
          <label class="md-nav__link" for="__nav_2_3_2" id="__nav_2_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modelling
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Modelling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Modelling/Association/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Association
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Modelling/Collection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Modelling/Decorators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decorators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Modelling/Element/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Element
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Modelling/Model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Modelling/Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Modelling/Preprocessor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocessor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Modelling/Validator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Modelling/Visitor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visitor
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3_3" id="__nav_2_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Protocols
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_3">
            <span class="md-nav__icon md-icon"></span>
            Protocols
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Protocols/Clock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Protocols/Future/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Future
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Protocols/Interpreter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interpreter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Protocols/Logger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Protocols/Queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Queue
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_4" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3_4" id="__nav_2_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    StateMachine
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3_4">
            <span class="md-nav__icon md-icon"></span>
            StateMachine
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Clock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Elements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Elements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Preprocessor
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Preprocessor
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor" class="md-nav__link">
    preprocessor
  </a>
  
    <nav class="md-nav" aria-label="preprocessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor" class="md-nav__link">
    StateMachinePreprocessor
  </a>
  
    <nav class="md-nav" aria-label="StateMachinePreprocessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.create_transition_path" class="md-nav__link">
    create_transition_path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_behavior" class="md-nav__link">
    preprocess_behavior()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_call_event" class="md-nav__link">
    preprocess_call_event()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_change_event" class="md-nav__link">
    preprocess_change_event()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_composite_state" class="md-nav__link">
    preprocess_composite_state()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_final_state" class="md-nav__link">
    preprocess_final_state()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_processor" class="md-nav__link">
    preprocess_processor()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_region" class="md-nav__link">
    preprocess_region()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_state" class="md-nav__link">
    preprocess_state()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_state_machine" class="md-nav__link">
    preprocess_state_machine()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_transition" class="md-nav__link">
    preprocess_transition()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_vertex" class="md-nav__link">
    preprocess_vertex()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.least_common_ancestor" class="md-nav__link">
    least_common_ancestor()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.no_activity" class="md-nav__link">
    no_activity()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.no_async_activity" class="md-nav__link">
    no_async_activity()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3_4_5" >
        
          
          <label class="md-nav__link" for="__nav_2_3_4_5" id="__nav_2_3_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Interpreters
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_4_5">
            <span class="md-nav__icon md-icon"></span>
            Interpreters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Interpreters/Async%20Behavior%20Interpreter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Async Behavior Interpreter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Interpreters/Async%20Interpreter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Async Interpreter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Interpreters/Async%20StateMachine%20Interpreter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Async StateMachine Interpreter
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Examples/Complete%20StateMachine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Complete StateMachine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Examples/LightSwitch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LightSwitch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Examples/Microwave/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microwave
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Examples/TrafficLight/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TrafficLight
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor" class="md-nav__link">
    preprocessor
  </a>
  
    <nav class="md-nav" aria-label="preprocessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor" class="md-nav__link">
    StateMachinePreprocessor
  </a>
  
    <nav class="md-nav" aria-label="StateMachinePreprocessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.create_transition_path" class="md-nav__link">
    create_transition_path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_behavior" class="md-nav__link">
    preprocess_behavior()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_call_event" class="md-nav__link">
    preprocess_call_event()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_change_event" class="md-nav__link">
    preprocess_change_event()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_composite_state" class="md-nav__link">
    preprocess_composite_state()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_final_state" class="md-nav__link">
    preprocess_final_state()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_processor" class="md-nav__link">
    preprocess_processor()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_region" class="md-nav__link">
    preprocess_region()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_state" class="md-nav__link">
    preprocess_state()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_state_machine" class="md-nav__link">
    preprocess_state_machine()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_transition" class="md-nav__link">
    preprocess_transition()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_vertex" class="md-nav__link">
    preprocess_vertex()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.least_common_ancestor" class="md-nav__link">
    least_common_ancestor()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.no_activity" class="md-nav__link">
    no_activity()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stateforward.state_machine.preprocessor.no_async_activity" class="md-nav__link">
    no_async_activity()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Preprocessor</h1>

<div class="doc doc-object doc-module">




<h2 id="stateforward.state_machine.preprocessor" class="doc doc-heading">
          <code>preprocessor</code>


</h2>

  <div class="doc doc-contents first">
  
      <p>The <code>preprocessor</code> module is responsible for transforming the abstract representation of a state machine into a form that is ready for execution. This involves enriching the state machine's constituents, such as vertices, transitions, and regions, with additional metadata and associations that are necessary for runtime processing. The preprocessing stage plays a crucial role in setting up the state machine by defining the relationships between its parts, refining its behaviors, and establishing the conditions for event handling and state transition.</p>
<p>The module provides a <code>StateMachinePreprocessor</code> class which houses methods corresponding to different elements of the state machine, including:</p>
<ul>
<li>
<p><code>preprocess_vertex</code>: It enriches vertices of the state machine by finding their containers, and categorizing incoming and outgoing transitions.</p>
</li>
<li>
<p><code>preprocess_state</code>: This method refines states by handling instances that are composite states and manages behaviors such as entry, exit, and activity. It also addresses the incorporation of submachines within states.</p>
</li>
<li>
<p><code>preprocess_composite_state</code>: Composite states, which contain regions and substates, are processed to ensure proper nesting and transition management.</p>
</li>
<li>
<p><code>create_transition_path</code>: Based on the kind of transition (external, local, or self), this method constructs a transition path that defines the order in which states are to be entered and exited during the transition.</p>
</li>
<li>
<p><code>preprocess_final_state</code>: This method handles the preprocessing of final states within the state machine.</p>
</li>
<li>
<p><code>preprocess_transition</code>: Transitions between states are prepared by associating sources, targets, containers, and events, and by determining the transition kind.</p>
</li>
<li>
<p><code>preprocess_region</code>: Regions, which are collections of vertices, are preprocessed such that each region is aware of its associated initial state and parent state machine or composite state.</p>
</li>
<li>
<p><code>preprocess_processor</code>: This method is responsible for setting up the interpreter with the correct asynchronous behavior if required by the state machine's concurrency model.</p>
</li>
<li>
<p><code>preprocess_call_event</code>, <code>preprocess_change_event</code>, and <code>preprocess_behavior</code>: These methods are dedicated to processing different types of events and behaviors, ensuring that their invocation and state changes are correctly managed according to whether the operations are coroutine functions or regular functions.</p>
</li>
<li>
<p><code>preprocess_state_machine</code>: Finally, this method ties together all preprocessing steps for the overall state machine, ensuring it is ready for execution with all the necessary properties and behaviors set up.</p>
</li>
</ul>
<p>This module does not depend on specific external imports as it's mainly focused on setting up the state machine internals based on provided abstract definitions. The class and method definitions within the module leverage functionalities from the <code>stateforward</code> package which defines the model and core functionalities required for state machine processing.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="stateforward.state_machine.preprocessor.StateMachinePreprocessor" class="doc doc-heading">
          <code>StateMachinePreprocessor</code>


</h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="stateforward.model.Preprocessor" href="../../Modelling/Preprocessor/#stateforward.model.preprocessor.Preprocessor">Preprocessor</a></code></p>

  
      <p>A preprocessor class for state machine models that extends the functionality of a base model preprocessor.
This class contains methods for preprocessing various elements within a state machine such as vertices, states, composite states, final states, transitions, regions, processors, call events, change events, behaviors, and the state machine itself. Each preprocessing method makes modifications to the elements, ensuring they are correctly configured within the state machineâ€™s model, and establishing connections and relationships as needed.
The class initializes with a logger attribute for logging messages and warnings during the preprocessing stage.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>log</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="stateforward.protocols.logger.Logger" href="../../Protocols/Logger/#stateforward.protocols.logger.Logger">Logger</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A logger instance used for outputting debug and error information during preprocessing.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Methods:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
          <tr>
            <td><code>preprocess_vertex</code></td>
            <td>
              <div class="doc-md-description">
                <p>Parses a vertex element, setting up its container, as well as outgoing and incoming transitions.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>preprocess_state</code></td>
            <td>
              <div class="doc-md-description">
                <p>Processes a state element, handling submachine preprocessing and setting up entry, exit, and activity behaviors before delegating to vertex preprocessing.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>preprocess_composite_state</code></td>
            <td>
              <div class="doc-md-description">
                <p>Handles preprocessing for composite states, creating regions, and categorizing internal transitions and subvertices.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>create_transition_path</code></td>
            <td>
              <div class="doc-md-description">
                <p>Creates a transition path for transitions, factoring in the kind of transition and the hierarchy of source and target states.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>preprocess_final_state</code></td>
            <td>
              <div class="doc-md-description">
                <p>Preprocessor for final state elements, mainly delegates to vertex preprocessing.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>preprocess_transition</code></td>
            <td>
              <div class="doc-md-description">
                <p>Handles the preparation of transition elements, setting source, target, events effect, container, and transition path.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>preprocess_region</code></td>
            <td>
              <div class="doc-md-description">
                <p>Processes region elements, setting up subvertices, initial states, state machines, and linkages to states or state machines.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>preprocess_processor</code></td>
            <td>
              <div class="doc-md-description">
                <p>Prepares a model interpreter with the appropriate queue depending on the concurrency kind.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>preprocess_call_event</code></td>
            <td>
              <div class="doc-md-description">
                <p>Processes call event elements, particularly attaching coroutine-friendly call methods when operations are asynchronous.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>preprocess_change_event</code></td>
            <td>
              <div class="doc-md-description">
                <p>Preprocesses change event elements and sets up associated conditions.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>preprocess_behavior</code></td>
            <td>
              <div class="doc-md-description">
                <p>Preprocessor for behavior elements, ensuring correct activities are set dependent on concurrency and establishing event pools and contexts.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>preprocess_state_machine</code></td>
            <td>
              <div class="doc-md-description">
                <p>Comprehensive preprocessing for the state machine which involves state, behavior, and transition preprocessing along with additional configurations.</p>
              </div>
            </td>
          </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StateMachinePreprocessor</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Preprocessor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A preprocessor class for state machine models that extends the functionality of a base model preprocessor.</span>
<span class="sd">    This class contains methods for preprocessing various elements within a state machine such as vertices, states, composite states, final states, transitions, regions, processors, call events, change events, behaviors, and the state machine itself. Each preprocessing method makes modifications to the elements, ensuring they are correctly configured within the state machineâ€™s model, and establishing connections and relationships as needed.</span>
<span class="sd">    The class initializes with a logger attribute for logging messages and warnings during the preprocessing stage.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        log (Logger):</span>
<span class="sd">             A logger instance used for outputting debug and error information during preprocessing.</span>

<span class="sd">    Methods:</span>
<span class="sd">        preprocess_vertex:</span>
<span class="sd">             Parses a vertex element, setting up its container, as well as outgoing and incoming transitions.</span>
<span class="sd">        preprocess_state:</span>
<span class="sd">             Processes a state element, handling submachine preprocessing and setting up entry, exit, and activity behaviors before delegating to vertex preprocessing.</span>
<span class="sd">        preprocess_composite_state:</span>
<span class="sd">             Handles preprocessing for composite states, creating regions, and categorizing internal transitions and subvertices.</span>
<span class="sd">        create_transition_path:</span>
<span class="sd">             Creates a transition path for transitions, factoring in the kind of transition and the hierarchy of source and target states.</span>
<span class="sd">        preprocess_final_state:</span>
<span class="sd">             Preprocessor for final state elements, mainly delegates to vertex preprocessing.</span>
<span class="sd">        preprocess_transition:</span>
<span class="sd">             Handles the preparation of transition elements, setting source, target, events effect, container, and transition path.</span>
<span class="sd">        preprocess_region:</span>
<span class="sd">             Processes region elements, setting up subvertices, initial states, state machines, and linkages to states or state machines.</span>
<span class="sd">        preprocess_processor:</span>
<span class="sd">             Prepares a model interpreter with the appropriate queue depending on the concurrency kind.</span>
<span class="sd">        preprocess_call_event:</span>
<span class="sd">             Processes call event elements, particularly attaching coroutine-friendly call methods when operations are asynchronous.</span>
<span class="sd">        preprocess_change_event:</span>
<span class="sd">             Preprocesses change event elements and sets up associated conditions.</span>
<span class="sd">        preprocess_behavior:</span>
<span class="sd">             Preprocessor for behavior elements, ensuring correct activities are set dependent on concurrency and establishing event pools and contexts.</span>
<span class="sd">        preprocess_state_machine:</span>
<span class="sd">             Comprehensive preprocessing for the state machine which involves state, behavior, and transition preprocessing along with additional configurations.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">log</span><span class="p">:</span> <span class="n">Logger</span> <span class="o">=</span> <span class="n">create_logger</span><span class="p">(</span><span class="s2">&quot;StateMachinePreprocessor&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">preprocess_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Vertex&quot;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes the given vertex by assigning it a container and categorizing its incoming and outgoing transitions.</span>

<span class="sd">        Args:</span>
<span class="sd">            element (type[&#39;core.Vertex&#39;]):</span>
<span class="sd">                 The vertex element to preprocess. This vertex should be part of a state machine model.</span>
<span class="sd">                The function logs the process of finding the container for the given vertex. If no container is found, an error is logged.</span>
<span class="sd">                Furthermore, the function identifies and categorizes all outgoing and incoming transitions of the vertex. It checks for transitions that are either originating from or targeting the element. It updates the &#39;outgoing&#39; and &#39;incoming&#39; attributes of the element with the newly found transitions.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">create_logger</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;preprocess_vertex(</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;finding container for </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">find_ancestor_of</span><span class="p">(</span>
            <span class="n">element</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">owned_element</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">owned_element</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Region</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">container</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;vertex </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2"> has no container&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;found container </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">container</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;container&quot;</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>

        <span class="n">outgoing</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">outgoing</span><span class="p">)</span> <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">outgoing</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="n">incoming</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">incoming</span><span class="p">)</span> <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">incoming</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">transition</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">find_descendants_of</span><span class="p">(</span>
            <span class="n">model</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">element</span><span class="p">),</span>
            <span class="k">lambda</span> <span class="n">owned_element</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span>
                <span class="n">owned_element</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Transition</span>
            <span class="p">),</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">transition</span><span class="o">.</span><span class="n">source</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">owner_of</span><span class="p">(</span><span class="n">transition</span><span class="p">)</span>
            <span class="p">)</span> <span class="o">==</span> <span class="n">element</span> <span class="ow">and</span> <span class="n">transition</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">outgoing</span><span class="p">:</span>
                <span class="n">outgoing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">transition</span><span class="o">.</span><span class="n">target</span> <span class="o">==</span> <span class="n">element</span> <span class="ow">and</span> <span class="n">transition</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">incoming</span><span class="p">:</span>
                <span class="n">incoming</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;outgoing&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="o">*</span><span class="n">outgoing</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;incoming&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="o">*</span><span class="n">incoming</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">preprocess_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.State&quot;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Preprocesses a state in the state machine for further operations.</span>
<span class="sd">        This method takes a state as an argument and performs preprocessing step depending on whether it is a composite state or contains a submachine. If the state has a submachine, it gets logged. Additionally, it handles the preprocessing for the vertices of the state and ensures that &#39;entry&#39;, &#39;exit&#39;, and &#39;activity&#39; behaviors are set on the state if they are not already defined.</span>

<span class="sd">        Args:</span>
<span class="sd">            element (core.State):</span>
<span class="sd">                 The state to preprocess. This type should be derived from a class that has an attribute &#39;submachine&#39;, which indicates whether the state is a simple state or a composite state with its own submachine.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">submachine</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_composite_state</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;preprocessing submachine </span><span class="si">{</span><span class="n">element</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;entry&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">None</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="c1"># for region in element.submachine.regions.core():</span>
            <span class="c1">#     model.set_attribute(region, &quot;state&quot;, element)</span>
            <span class="c1">#     model.set_attribute(region, &quot;state_machine&quot;, None)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_vertex</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">behavior</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;entry&quot;</span><span class="p">,</span> <span class="s2">&quot;exit&quot;</span><span class="p">,</span> <span class="s2">&quot;activity&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">behavior</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
                    <span class="n">element</span><span class="p">,</span>
                    <span class="n">behavior</span><span class="p">,</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">behavior</span><span class="p">,</span> <span class="n">bases</span><span class="o">=</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">Behavior</span><span class="p">,)),</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">preprocess_composite_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.CompositeState&quot;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes a composite state to organize its sub-elements such as transitions, vertices, and regions.</span>
<span class="sd">        This method takes an element that is assumed to be a composite state, and iterates over its owned elements</span>
<span class="sd">        to categorize them into transitions, subvertices, and regions. If there are subvertices without an enclosing region,</span>
<span class="sd">        a new region is created to contain them along with any associated transitions. Existing regions within the composite state</span>
<span class="sd">        are preserved. The method then ensures that all transitions and subvertices are assigned to a region, either the new region</span>
<span class="sd">        or one of the existing ones, by updating their &#39;container&#39; attributes. If an owned element corresponds to an attribute of</span>
<span class="sd">        the composite state, that association is maintained within the newly formed or existing region.</span>

<span class="sd">        Args:</span>
<span class="sd">            element (type[&#39;core.CompositeState&#39;]):</span>
<span class="sd">                 The composite state to be preprocessed, expected to be an instance of &#39;core.CompositeState&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None:</span>
<span class="sd">                 This method modifies the composite state element in-place and has no return value.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">transitions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">subvertex</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">regions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">owned_element</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="n">_owned_element</span>
            <span class="k">for</span> <span class="n">_owned_element</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">owned_elements_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span>
                <span class="n">model</span><span class="o">.</span><span class="n">is_descendant_of</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">_owned_element</span><span class="p">)</span> <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span>
            <span class="p">)</span>
        <span class="p">]:</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">owned_element</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Transition</span><span class="p">):</span>
                <span class="n">transitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">owned_element</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_type</span><span class="p">(</span><span class="n">owned_element</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">Collection</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
                <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">_child</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Transition</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">_child</span> <span class="ow">in</span> <span class="n">owned_element</span>
            <span class="p">):</span>
                <span class="n">transitions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">owned_element</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">owned_element</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Vertex</span><span class="p">):</span>
                <span class="n">subvertex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">owned_element</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">owned_element</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Region</span><span class="p">):</span>
                <span class="n">regions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">owned_element</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subvertex</span><span class="p">:</span>
            <span class="n">new_region</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;region_</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">bases</span><span class="o">=</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">Region</span><span class="p">,),</span>
            <span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
                <span class="n">element</span><span class="p">,</span>
                <span class="s2">&quot;regions&quot;</span><span class="p">,</span>
                <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="n">new_region</span><span class="p">,</span> <span class="o">*</span><span class="n">regions</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">owned_element</span> <span class="ow">in</span> <span class="n">subvertex</span> <span class="o">+</span> <span class="n">transitions</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">owner_of_owned_element</span> <span class="o">:=</span> <span class="n">model</span><span class="o">.</span><span class="n">owner_of</span><span class="p">(</span><span class="n">owned_element</span><span class="p">)</span>
                <span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">owned_element</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">remove_owned_element_from</span><span class="p">(</span>
                        <span class="n">owner_of_owned_element</span><span class="p">,</span> <span class="n">owned_element</span>
                    <span class="p">)</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">owned_element</span><span class="p">,</span> <span class="s2">&quot;container&quot;</span><span class="p">,</span> <span class="n">new_region</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">owned_element_name</span> <span class="o">:=</span> <span class="n">model</span><span class="o">.</span><span class="n">name_of</span><span class="p">(</span><span class="n">owned_element</span><span class="p">)</span>
                <span class="p">)</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">attributes_of</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">new_region</span><span class="p">,</span> <span class="n">owned_element_name</span><span class="p">,</span> <span class="n">owned_element</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">add_owned_element_to</span><span class="p">(</span><span class="n">new_region</span><span class="p">,</span> <span class="n">owned_element</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">regions</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;regions&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="o">*</span><span class="n">regions</span><span class="p">))</span>

        <span class="c1"># else:</span>
        <span class="c1">#     model.set_attribute(element, &quot;region&quot;, model.collection())</span>

    <span class="k">def</span> <span class="nf">create_transition_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transition</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Transition&quot;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and returns a transition path object based on the provided transition.</span>
<span class="sd">        This method analyzes the provided transition object to determine the path of</span>
<span class="sd">        state entries and exits required for a state machine transition. This is done</span>
<span class="sd">        by examining the `source`, `target`, and `kind` attributes of the `transition`</span>
<span class="sd">        object. Depending on the kind of transition (external, local, or self), it</span>
<span class="sd">        assembles two lists representing the states to be entered (&#39;enter&#39;) and the</span>
<span class="sd">        states to be left (&#39;leave&#39;). The method then uses these lists to create a new</span>
<span class="sd">        transition path object with &#39;enter&#39; and &#39;leave&#39; as its attributes.</span>

<span class="sd">        Args:</span>
<span class="sd">            transition (core.Transition):</span>
<span class="sd">                 The transition object whose path needs</span>
<span class="sd">                to be created.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">enter</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">leave</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># TODO this can be reduced</span>
        <span class="k">if</span> <span class="n">transition</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">external</span><span class="p">:</span>
            <span class="n">leave</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ancestor</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">ancestors_of</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">source</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">ancestor</span><span class="p">)</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">container</span><span class="p">):</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">ancestor</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">State</span><span class="p">):</span>
                    <span class="n">leave</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ancestor</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ancestor</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">ancestors_of</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">target</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">ancestor</span><span class="p">)</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">container</span><span class="p">):</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">ancestor</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">State</span><span class="p">):</span>
                    <span class="n">enter</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ancestor</span><span class="p">)</span>
            <span class="n">enter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">transition</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">local</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ancestor</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">ancestors_of</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">target</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">ancestor</span><span class="p">)</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">source</span><span class="p">):</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">ancestor</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">State</span><span class="p">):</span>
                    <span class="n">enter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ancestor</span><span class="p">)</span>
            <span class="n">enter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">transition</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">self</span><span class="p">:</span>
            <span class="n">leave</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
            <span class="n">enter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
            <span class="s2">&quot;path&quot;</span><span class="p">,</span>
            <span class="n">bases</span><span class="o">=</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">TransitionPath</span><span class="p">,),</span>
            <span class="n">enter</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="o">*</span><span class="n">enter</span><span class="p">),</span>
            <span class="n">leave</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="o">*</span><span class="n">leave</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">preprocess_final_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.FinalState&quot;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes a final state element within the state machine before compilation.</span>
<span class="sd">        This method is responsible for applying preprocessing steps to the given final state element</span>
<span class="sd">        within the context of the state machine. It is designed to be overridden in subclasses for</span>
<span class="sd">        specific behaviors. The default implementation delegates the preprocessing to the</span>
<span class="sd">        `preprocess_vertex` method.</span>

<span class="sd">        Args:</span>
<span class="sd">            element (type[&#39;core.FinalState&#39;]):</span>
<span class="sd">                 The final state element of the state machine to preprocess.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_vertex</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">preprocess_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Transition&quot;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Preprocesses the transition element to ensure it has all the necessary attributes set up correctly.</span>
<span class="sd">        This method processes a given transition element by setting up default values and verifying its</span>
<span class="sd">        correctness within a state machine. It checks if the transition source is defined, and if not,</span>
<span class="sd">        it attempts to derive the source based on hierarchy and ownership rules. It handles the completion</span>
<span class="sd">        events for states, initializes an empty effect if none is provided, and determines the transition</span>
<span class="sd">        kind based on the relationship between the source and target.</span>

<span class="sd">        Args:</span>
<span class="sd">            element (type[&#39;core.Transition&#39;]):</span>
<span class="sd">                 The transition element to preprocess.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError:</span>
<span class="sd">                 If the transition source is not found or if the transition has no container.</span>
<span class="sd">                This function does not return any value but modifies the transition element in place.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">source</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">owner</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">owner_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">Collection</span><span class="p">):</span>
                <span class="n">owner</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">owner_of</span><span class="p">(</span><span class="n">owner</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Vertex</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;transition </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2"> has no source and is not owned by a state&quot;</span>
                <span class="p">)</span>
            <span class="c1"># transition source always defaults to the parent</span>
            <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="n">owner</span><span class="p">)</span>

        <span class="c1"># yield from self.wait_for_completion_of(element.source)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_element</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">events</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">State</span><span class="p">):</span>
                <span class="n">completion</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">completion</span>
                <span class="k">if</span> <span class="n">completion</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">completion</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
                        <span class="s2">&quot;completion&quot;</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">CompletionEvent</span><span class="p">,),</span>
                    <span class="p">)</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="s2">&quot;completion&quot;</span><span class="p">,</span> <span class="n">completion</span><span class="p">)</span>

                <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
                    <span class="n">element</span><span class="p">,</span>
                    <span class="s2">&quot;events&quot;</span><span class="p">,</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span>
                        <span class="n">completion</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">effect</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
                <span class="n">element</span><span class="p">,</span>
                <span class="s2">&quot;effect&quot;</span><span class="p">,</span>
                <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
                    <span class="s2">&quot;effect&quot;</span><span class="p">,</span>
                    <span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">Behavior</span><span class="p">,),</span>
                    <span class="n">activity</span><span class="o">=</span><span class="n">no_async_activity</span>
                    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="n">concurrency_kind</span>
                    <span class="ow">is</span> <span class="n">core</span><span class="o">.</span><span class="n">ConcurrencyKind</span><span class="o">.</span><span class="n">asynchronous</span>
                    <span class="k">else</span> <span class="n">no_activity</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">container</span>
        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="n">element</span><span class="o">.</span><span class="n">target</span><span class="p">:</span>
            <span class="n">element</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">self</span>
        <span class="k">elif</span> <span class="n">element</span><span class="o">.</span><span class="n">target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">element</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">internal</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">is_descendant_of</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">target</span><span class="p">):</span>
            <span class="n">element</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">local</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_element</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
            <span class="n">element</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">external</span>
            <span class="n">container</span> <span class="o">=</span> <span class="n">least_common_ancestor</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">container</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;transition </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2"> has no container&quot;</span>
            <span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;container&quot;</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_transition_path</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">preprocess_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Region&quot;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes the given UML region by setting attributes and filtering sub-elements.</span>
<span class="sd">        This method takes an element of type &#39;core.Region&#39; and performs preprocessing to set attributes</span>
<span class="sd">        related to its subvertices, initial state, parent state, and parent state machine. It identifies</span>
<span class="sd">        all the subvertices of the region that are of type &#39;core.Vertex&#39; and sets the &#39;subvertex&#39; attribute.</span>
<span class="sd">        If the region does not have an explicit initial state, this method will attempt to find one based on</span>
<span class="sd">        the provided filtering criteria. Once an initial state is identified or confirmed, the method sets</span>
<span class="sd">        the &#39;initial&#39; attribute of the element.</span>
<span class="sd">        The method also discerns and sets attributes for the region&#39;s parent state and state machine,</span>
<span class="sd">        ensuring that each is appropriately classified as either a &#39;core.State&#39; or &#39;StateMachine&#39;.</span>

<span class="sd">        Args:</span>
<span class="sd">            element (type[&#39;core.Region&#39;]):</span>
<span class="sd">                 The region of a state machine to preprocess.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError:</span>
<span class="sd">                 If the attributes related to &#39;subvertex&#39;, &#39;initial&#39;, &#39;state&#39;, or</span>
<span class="sd">                &#39;state_machine&#39; cannot be set due to incorrect typing or hierarchy of the provided element.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">stateforward.core</span> <span class="kn">import</span> <span class="n">StateMachine</span>

        <span class="k">def</span> <span class="nf">initial_filter</span><span class="p">(</span><span class="n">vertex</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Determines whether a given vertex is a subtype of core.Initial.</span>

<span class="sd">            Args:</span>
<span class="sd">                vertex (Any):</span>
<span class="sd">                     The vertex to be checked for being a subtype.</span>

<span class="sd">            Returns:</span>
<span class="sd">                bool:</span>
<span class="sd">                     True if the vertex is a subtype of core.Initial, otherwise False.</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">vertex</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Initial</span><span class="p">)</span>

        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
            <span class="n">element</span><span class="p">,</span>
            <span class="s2">&quot;subvertex&quot;</span><span class="p">,</span>
            <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span>
                <span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">find_owned_elements_of</span><span class="p">(</span>
                    <span class="n">element</span><span class="p">,</span>
                    <span class="k">lambda</span> <span class="n">owned_element</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span>
                        <span class="n">owned_element</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Vertex</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="n">initial</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;initial&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">initial</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">initial</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">find_owned_element_of</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">initial_filter</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;initial&quot;</span><span class="p">,</span> <span class="n">initial</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;region </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2"> has initial </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">initial</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">owner_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="p">(</span><span class="n">StateMachine</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">State</span><span class="p">)):</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">owner_of</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
            <span class="n">element</span><span class="p">,</span>
            <span class="s2">&quot;state&quot;</span><span class="p">,</span>
            <span class="n">parent</span> <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">State</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
            <span class="n">element</span><span class="p">,</span>
            <span class="s2">&quot;state_machine&quot;</span><span class="p">,</span>
            <span class="n">parent</span> <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">StateMachine</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">preprocess_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;model.Interpreter&quot;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Preprocesses an interpreter element to set up queue characteristics based on concurrency type.</span>
<span class="sd">        This method examines the concurrency_kind attribute of the provided interpreter element and sets an attribute to use an asynchronous queue if the concurrency kind matches asynchronous operation.</span>

<span class="sd">        Args:</span>
<span class="sd">            element (type[&#39;model.Interpreter&#39;]):</span>
<span class="sd">                 The interpreter element to preprocess, it must be an instance or subclass of model.Interpreter. The element is expected to have a model property with a concurrency_kind attribute.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError:</span>
<span class="sd">                 If the &#39;model&#39; property or &#39;concurrency_kind&#39; attribute is missing from the element.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">concurrency_kind</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">concurrency_kind</span>
        <span class="k">if</span> <span class="n">concurrency_kind</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">ConcurrencyKind</span><span class="o">.</span><span class="n">asynchronous</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;queue&quot;</span><span class="p">,</span> <span class="n">AsyncQueue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">preprocess_call_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.CallEvent&quot;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes the provided CallEvent by setting the appropriate __call__ attribute,</span>
<span class="sd">        depending on whether the operation is a coroutine function or not.</span>
<span class="sd">        This method decorates the given CallEvent&#39;s operation with a new __call__ method.</span>
<span class="sd">        If the operation is an asynchronous coroutine function, it wraps the call in an</span>
<span class="sd">        &#39;async def&#39; to handle the coroutine execution, sends an event to the model&#39;s interpreter,</span>
<span class="sd">        and then returns the result upon completion. If the operation is a regular function,</span>
<span class="sd">        it wraps the call in a &#39;def&#39; and sets the result before returning.</span>
<span class="sd">        After processing, the CallEvent can be invoked as a callable which automatically</span>
<span class="sd">        handles the operation execution and result management.</span>

<span class="sd">        Args:</span>
<span class="sd">            element (type[&#39;core.CallEvent&#39;]):</span>
<span class="sd">                 The CallEvent instance to be preprocessed.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError:</span>
<span class="sd">                 If the &#39;operation&#39; attribute is not found in the CallEvent.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">iscoroutinefunction</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">operation</span><span class="p">):</span>

            <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Performs an asynchronous operation and then sends its class instance to the model&#39;s interpreter.</span>
<span class="sd">                This asynchronous method is a coroutine that must be awaited. It wraps an internal operation coroutine, invokes it with the supplied arguments, and then sends the current class instance to the associated interpreter, which is an attribute of the model object.</span>

<span class="sd">                Args:</span>
<span class="sd">                    *args:</span>
<span class="sd">                         Variable length argument list to be passed to the internal operation coroutine.</span>
<span class="sd">                    **kwargs:</span>
<span class="sd">                         Arbitrary keyword arguments to be passed to the internal operation coroutine.</span>

<span class="sd">                Returns:</span>

<span class="sd">                Raises:</span>
<span class="sd">                    Exception:</span>
<span class="sd">                         Propagates any exceptions raised by the internal operation coroutine or the model&#39;s interpreter.</span>

<span class="sd">                &quot;&quot;&quot;</span>
                <span class="n">value</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">())</span>
                <span class="k">return</span> <span class="n">value</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Performs the operation bound to the callable object and stores the result.</span>
<span class="sd">                This method allows the instance to be called as a function, executing the operation method</span>
<span class="sd">                with the provided arguments and keyword arguments. After execution, the result is saved</span>
<span class="sd">                using the results attribute&#39;s set_result method.</span>

<span class="sd">                Args:</span>
<span class="sd">                    *args:</span>
<span class="sd">                         Variable length argument list that will be passed to the operation method.</span>
<span class="sd">                    **kwargs:</span>
<span class="sd">                         Arbitrary keyword arguments that will be passed to the operation method.</span>

<span class="sd">                Returns:</span>

<span class="sd">                &quot;&quot;&quot;</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">value</span>

        <span class="nb">setattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;__call__&quot;</span><span class="p">,</span> <span class="fm">__call__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">preprocess_change_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">core</span><span class="o">.</span><span class="n">ChangeEvent</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Preprocesses a ChangeEvent object by assigning an asyncio.Condition to its &#39;condition&#39; attribute.</span>

<span class="sd">        Args:</span>
<span class="sd">            element (type[core.ChangeEvent]):</span>
<span class="sd">                 The ChangeEvent instance that is to be preprocessed.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError:</span>
<span class="sd">                 If &#39;condition&#39; is not an attribute of the provided ChangeEvent instance.</span>

<span class="sd">        Note:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">element</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Condition</span>

    <span class="k">def</span> <span class="nf">preprocess_behavior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Behavior&quot;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Preprocesses the behavior element to set up appropriate activities and contexts.</span>
<span class="sd">        This method takes a behavior element and does the following:</span>
<span class="sd">        - Determines the type of concurrency (asynchronous or synchronous) and assigns the correct no-activity function if the activity is not provided.</span>
<span class="sd">        - If concurrency is asynchronous and the activity is not a coroutine function, it wraps the provided activity inside a function that can handle coroutine calling conventions.</span>
<span class="sd">        - Sets the &#39;activity&#39; attribute of the behavior element to the processed activity function, ensuring that it has appropriate module and qualname attributes.</span>
<span class="sd">        - Identifies the context of the behavior by finding the ancestor element that is a subtype of core.Behavior.</span>
<span class="sd">        - Processes all owned elements of the behavior element.</span>
<span class="sd">        - Collects all events that are descendants of the behavior element and assigns them to the &#39;pool&#39; attribute.</span>
<span class="sd">        - Sets the &#39;context&#39; attribute of the behavior element to the identified context.</span>

<span class="sd">        Args:</span>
<span class="sd">            element (type[&#39;core.Behavior&#39;]):</span>
<span class="sd">                 The behavior element to preprocess.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">concurrency_kind</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="n">concurrency_kind</span>
        <span class="n">activity</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">activity</span>
        <span class="k">if</span> <span class="n">activity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">concurrency_kind</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">ConcurrencyKind</span><span class="o">.</span><span class="n">asynchronous</span><span class="p">:</span>
                <span class="n">activity</span> <span class="o">=</span> <span class="n">no_async_activity</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">activity</span> <span class="o">=</span> <span class="n">no_activity</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">concurrency_kind</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">ConcurrencyKind</span><span class="o">.</span><span class="n">asynchronous</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">iscoroutinefunction</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">activity</span><span class="p">)</span>
        <span class="p">):</span>

            <span class="k">def</span> <span class="nf">activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="s2">&quot;core.Event&quot;</span><span class="p">,</span> <span class="n">_activity</span><span class="o">=</span><span class="n">element</span><span class="o">.</span><span class="n">activity</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Performs an activity associated with a given event.</span>
<span class="sd">                This function is designed to execute a specific activity that is tied to an event passed to the function. The activity to be executed is provided by the _activity argument, which defaults to `element.activity`. It calls this provided activity function, passing in the instance (`self`) and the event object.</span>

<span class="sd">                Args:</span>
<span class="sd">                    event (core.Event):</span>
<span class="sd">                         The event object that is associated with the activity to be performed.</span>
<span class="sd">                    _activity (callable, optional):</span>
<span class="sd">                         A callable that represents the activity to be performed when the function is called. Defaults to `element.activity` if not provided.</span>

<span class="sd">                Returns:</span>

<span class="sd">                &quot;&quot;&quot;</span>
                <span class="k">return</span> <span class="n">_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>

        <span class="n">activity</span><span class="o">.</span><span class="vm">__module__</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="vm">__module__</span>
        <span class="n">activity</span><span class="o">.</span><span class="vm">__qualname__</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2">.activity&quot;</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;activity&quot;</span><span class="p">,</span> <span class="n">activity</span><span class="p">)</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">find_ancestor_of</span><span class="p">(</span>
            <span class="n">element</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">ancestor</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">ancestor</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Behavior</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_owned_elements</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>

        <span class="n">events</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">descendant</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">descendants_of</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">descendant</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Event</span><span class="p">):</span>
                <span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">descendant</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;pool&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="o">*</span><span class="n">events</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
            <span class="n">element</span><span class="p">,</span>
            <span class="s2">&quot;context&quot;</span><span class="p">,</span>
            <span class="n">context</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">preprocess_state_machine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Behavior&quot;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Preprocesses a state machine behavior object prior to compilation.</span>
<span class="sd">        This method takes an element which is an instance of a specific state machine behavior and performs preprocessing steps on it. These steps involve preprocessing any composite states within the element and the behavior itself. This is essential to prepare the element for subsequent compilation or transformation processes. It involves logging the preprocessing step, ensuring internal consistency, setting up necessary ordering, and potentially more based on the implementation details.</span>
<span class="sd">        The function concludes by sorting a collection within the state machine. The sorting criteria is based on the type of event; it prioritizes non-completion events over completion events. This ordering may affect how events are processed or triggered within the state machine behavior at runtime.</span>

<span class="sd">        Args:</span>
<span class="sd">            element (core.Behavior):</span>
<span class="sd">                 The state machine behavior to preprocess. This is expected to be a subtype of &#39;core.Behavior&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None:</span>
<span class="sd">                 This method performs operations on the &#39;element&#39; object but does not return any value.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;preprocessing state machine </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">submachine_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_state</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">submachine_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_composite_state</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_behavior</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">sort_collection</span><span class="p">(</span>
            <span class="n">element</span><span class="o">.</span><span class="n">pool</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="ow">not</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">CompletionEvent</span><span class="p">),</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h4 id="stateforward.state_machine.preprocessor.StateMachinePreprocessor.create_transition_path" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_transition_path</span><span class="p">(</span><span class="n">transition</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Generates and returns a transition path object based on the provided transition.
This method analyzes the provided transition object to determine the path of
state entries and exits required for a state machine transition. This is done
by examining the <code>source</code>, <code>target</code>, and <code>kind</code> attributes of the <code>transition</code>
object. Depending on the kind of transition (external, local, or self), it
assembles two lists representing the states to be entered ('enter') and the
states to be left ('leave'). The method then uses these lists to create a new
transition path object with 'enter' and 'leave' as its attributes.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>transition</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="stateforward.core.Transition" href="../../Core/Elements/#stateforward.core.elements.Transition">Transition</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The transition object whose path needs
to be created.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:</p>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_transition_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transition</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Transition&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates and returns a transition path object based on the provided transition.</span>
<span class="sd">    This method analyzes the provided transition object to determine the path of</span>
<span class="sd">    state entries and exits required for a state machine transition. This is done</span>
<span class="sd">    by examining the `source`, `target`, and `kind` attributes of the `transition`</span>
<span class="sd">    object. Depending on the kind of transition (external, local, or self), it</span>
<span class="sd">    assembles two lists representing the states to be entered (&#39;enter&#39;) and the</span>
<span class="sd">    states to be left (&#39;leave&#39;). The method then uses these lists to create a new</span>
<span class="sd">    transition path object with &#39;enter&#39; and &#39;leave&#39; as its attributes.</span>

<span class="sd">    Args:</span>
<span class="sd">        transition (core.Transition):</span>
<span class="sd">             The transition object whose path needs</span>
<span class="sd">            to be created.</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">enter</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">leave</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># TODO this can be reduced</span>
    <span class="k">if</span> <span class="n">transition</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">external</span><span class="p">:</span>
        <span class="n">leave</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ancestor</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">ancestors_of</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">source</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">ancestor</span><span class="p">)</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">container</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">ancestor</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">State</span><span class="p">):</span>
                <span class="n">leave</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ancestor</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ancestor</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">ancestors_of</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">target</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">ancestor</span><span class="p">)</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">container</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">ancestor</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">State</span><span class="p">):</span>
                <span class="n">enter</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ancestor</span><span class="p">)</span>
        <span class="n">enter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">transition</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">local</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ancestor</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">ancestors_of</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">target</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">ancestor</span><span class="p">)</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">id_of</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">source</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">ancestor</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">State</span><span class="p">):</span>
                <span class="n">enter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ancestor</span><span class="p">)</span>
        <span class="n">enter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">transition</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">self</span><span class="p">:</span>
        <span class="n">leave</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
        <span class="n">enter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
        <span class="s2">&quot;path&quot;</span><span class="p">,</span>
        <span class="n">bases</span><span class="o">=</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">TransitionPath</span><span class="p">,),</span>
        <span class="n">enter</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="o">*</span><span class="n">enter</span><span class="p">),</span>
        <span class="n">leave</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="o">*</span><span class="n">leave</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_behavior" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_behavior</span><span class="p">(</span><span class="n">element</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Preprocesses the behavior element to set up appropriate activities and contexts.
This method takes a behavior element and does the following:
- Determines the type of concurrency (asynchronous or synchronous) and assigns the correct no-activity function if the activity is not provided.
- If concurrency is asynchronous and the activity is not a coroutine function, it wraps the provided activity inside a function that can handle coroutine calling conventions.
- Sets the 'activity' attribute of the behavior element to the processed activity function, ensuring that it has appropriate module and qualname attributes.
- Identifies the context of the behavior by finding the ancestor element that is a subtype of core.Behavior.
- Processes all owned elements of the behavior element.
- Collects all events that are descendants of the behavior element and assigns them to the 'pool' attribute.
- Sets the 'context' attribute of the behavior element to the identified context.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>element</code></td>
          <td>
                <code>type[<a class="autorefs autorefs-internal" title="stateforward.core.Behavior" href="../../Core/Elements/#stateforward.core.elements.Behavior">Behavior</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The behavior element to preprocess.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_behavior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Behavior&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Preprocesses the behavior element to set up appropriate activities and contexts.</span>
<span class="sd">    This method takes a behavior element and does the following:</span>
<span class="sd">    - Determines the type of concurrency (asynchronous or synchronous) and assigns the correct no-activity function if the activity is not provided.</span>
<span class="sd">    - If concurrency is asynchronous and the activity is not a coroutine function, it wraps the provided activity inside a function that can handle coroutine calling conventions.</span>
<span class="sd">    - Sets the &#39;activity&#39; attribute of the behavior element to the processed activity function, ensuring that it has appropriate module and qualname attributes.</span>
<span class="sd">    - Identifies the context of the behavior by finding the ancestor element that is a subtype of core.Behavior.</span>
<span class="sd">    - Processes all owned elements of the behavior element.</span>
<span class="sd">    - Collects all events that are descendants of the behavior element and assigns them to the &#39;pool&#39; attribute.</span>
<span class="sd">    - Sets the &#39;context&#39; attribute of the behavior element to the identified context.</span>

<span class="sd">    Args:</span>
<span class="sd">        element (type[&#39;core.Behavior&#39;]):</span>
<span class="sd">             The behavior element to preprocess.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">concurrency_kind</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="n">concurrency_kind</span>
    <span class="n">activity</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">activity</span>
    <span class="k">if</span> <span class="n">activity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">concurrency_kind</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">ConcurrencyKind</span><span class="o">.</span><span class="n">asynchronous</span><span class="p">:</span>
            <span class="n">activity</span> <span class="o">=</span> <span class="n">no_async_activity</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">activity</span> <span class="o">=</span> <span class="n">no_activity</span>
    <span class="k">elif</span> <span class="p">(</span>
        <span class="n">concurrency_kind</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">ConcurrencyKind</span><span class="o">.</span><span class="n">asynchronous</span>
        <span class="ow">and</span> <span class="ow">not</span> <span class="n">iscoroutinefunction</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">activity</span><span class="p">)</span>
    <span class="p">):</span>

        <span class="k">def</span> <span class="nf">activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="s2">&quot;core.Event&quot;</span><span class="p">,</span> <span class="n">_activity</span><span class="o">=</span><span class="n">element</span><span class="o">.</span><span class="n">activity</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Performs an activity associated with a given event.</span>
<span class="sd">            This function is designed to execute a specific activity that is tied to an event passed to the function. The activity to be executed is provided by the _activity argument, which defaults to `element.activity`. It calls this provided activity function, passing in the instance (`self`) and the event object.</span>

<span class="sd">            Args:</span>
<span class="sd">                event (core.Event):</span>
<span class="sd">                     The event object that is associated with the activity to be performed.</span>
<span class="sd">                _activity (callable, optional):</span>
<span class="sd">                     A callable that represents the activity to be performed when the function is called. Defaults to `element.activity` if not provided.</span>

<span class="sd">            Returns:</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>

    <span class="n">activity</span><span class="o">.</span><span class="vm">__module__</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="vm">__module__</span>
    <span class="n">activity</span><span class="o">.</span><span class="vm">__qualname__</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2">.activity&quot;</span>
    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;activity&quot;</span><span class="p">,</span> <span class="n">activity</span><span class="p">)</span>
    <span class="n">context</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">find_ancestor_of</span><span class="p">(</span>
        <span class="n">element</span><span class="p">,</span>
        <span class="k">lambda</span> <span class="n">ancestor</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">ancestor</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Behavior</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_owned_elements</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>

    <span class="n">events</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">descendant</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">descendants_of</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">descendant</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Event</span><span class="p">):</span>
            <span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">descendant</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;pool&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="o">*</span><span class="n">events</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
        <span class="n">element</span><span class="p">,</span>
        <span class="s2">&quot;context&quot;</span><span class="p">,</span>
        <span class="n">context</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_call_event" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_call_event</span><span class="p">(</span><span class="n">element</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Processes the provided CallEvent by setting the appropriate <strong>call</strong> attribute,
depending on whether the operation is a coroutine function or not.
This method decorates the given CallEvent's operation with a new <strong>call</strong> method.
If the operation is an asynchronous coroutine function, it wraps the call in an
'async def' to handle the coroutine execution, sends an event to the model's interpreter,
and then returns the result upon completion. If the operation is a regular function,
it wraps the call in a 'def' and sets the result before returning.
After processing, the CallEvent can be invoked as a callable which automatically
handles the operation execution and result management.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>element</code></td>
          <td>
                <code>type[<a class="autorefs autorefs-internal" title="stateforward.core.CallEvent" href="../../Core/Elements/#stateforward.core.elements.CallEvent">CallEvent</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The CallEvent instance to be preprocessed.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>AttributeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the 'operation' attribute is not found in the CallEvent.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_call_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.CallEvent&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Processes the provided CallEvent by setting the appropriate __call__ attribute,</span>
<span class="sd">    depending on whether the operation is a coroutine function or not.</span>
<span class="sd">    This method decorates the given CallEvent&#39;s operation with a new __call__ method.</span>
<span class="sd">    If the operation is an asynchronous coroutine function, it wraps the call in an</span>
<span class="sd">    &#39;async def&#39; to handle the coroutine execution, sends an event to the model&#39;s interpreter,</span>
<span class="sd">    and then returns the result upon completion. If the operation is a regular function,</span>
<span class="sd">    it wraps the call in a &#39;def&#39; and sets the result before returning.</span>
<span class="sd">    After processing, the CallEvent can be invoked as a callable which automatically</span>
<span class="sd">    handles the operation execution and result management.</span>

<span class="sd">    Args:</span>
<span class="sd">        element (type[&#39;core.CallEvent&#39;]):</span>
<span class="sd">             The CallEvent instance to be preprocessed.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AttributeError:</span>
<span class="sd">             If the &#39;operation&#39; attribute is not found in the CallEvent.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">iscoroutinefunction</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">operation</span><span class="p">):</span>

        <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Performs an asynchronous operation and then sends its class instance to the model&#39;s interpreter.</span>
<span class="sd">            This asynchronous method is a coroutine that must be awaited. It wraps an internal operation coroutine, invokes it with the supplied arguments, and then sends the current class instance to the associated interpreter, which is an attribute of the model object.</span>

<span class="sd">            Args:</span>
<span class="sd">                *args:</span>
<span class="sd">                     Variable length argument list to be passed to the internal operation coroutine.</span>
<span class="sd">                **kwargs:</span>
<span class="sd">                     Arbitrary keyword arguments to be passed to the internal operation coroutine.</span>

<span class="sd">            Returns:</span>

<span class="sd">            Raises:</span>
<span class="sd">                Exception:</span>
<span class="sd">                     Propagates any exceptions raised by the internal operation coroutine or the model&#39;s interpreter.</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">value</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">value</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Performs the operation bound to the callable object and stores the result.</span>
<span class="sd">            This method allows the instance to be called as a function, executing the operation method</span>
<span class="sd">            with the provided arguments and keyword arguments. After execution, the result is saved</span>
<span class="sd">            using the results attribute&#39;s set_result method.</span>

<span class="sd">            Args:</span>
<span class="sd">                *args:</span>
<span class="sd">                     Variable length argument list that will be passed to the operation method.</span>
<span class="sd">                **kwargs:</span>
<span class="sd">                     Arbitrary keyword arguments that will be passed to the operation method.</span>

<span class="sd">            Returns:</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>

    <span class="nb">setattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;__call__&quot;</span><span class="p">,</span> <span class="fm">__call__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_change_event" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_change_event</span><span class="p">(</span><span class="n">element</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Preprocesses a ChangeEvent object by assigning an asyncio.Condition to its 'condition' attribute.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>element</code></td>
          <td>
                <code>type[<a class="autorefs autorefs-internal" title="stateforward.core.ChangeEvent" href="../../Core/Elements/#stateforward.core.elements.ChangeEvent">ChangeEvent</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The ChangeEvent instance that is to be preprocessed.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>AttributeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If 'condition' is not an attribute of the provided ChangeEvent instance.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Note:</p>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_change_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">core</span><span class="o">.</span><span class="n">ChangeEvent</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Preprocesses a ChangeEvent object by assigning an asyncio.Condition to its &#39;condition&#39; attribute.</span>

<span class="sd">    Args:</span>
<span class="sd">        element (type[core.ChangeEvent]):</span>
<span class="sd">             The ChangeEvent instance that is to be preprocessed.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AttributeError:</span>
<span class="sd">             If &#39;condition&#39; is not an attribute of the provided ChangeEvent instance.</span>

<span class="sd">    Note:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Condition</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_composite_state" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_composite_state</span><span class="p">(</span><span class="n">element</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Processes a composite state to organize its sub-elements such as transitions, vertices, and regions.
This method takes an element that is assumed to be a composite state, and iterates over its owned elements
to categorize them into transitions, subvertices, and regions. If there are subvertices without an enclosing region,
a new region is created to contain them along with any associated transitions. Existing regions within the composite state
are preserved. The method then ensures that all transitions and subvertices are assigned to a region, either the new region
or one of the existing ones, by updating their 'container' attributes. If an owned element corresponds to an attribute of
the composite state, that association is maintained within the newly formed or existing region.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>element</code></td>
          <td>
                <code>type[<a class="autorefs autorefs-internal" title="stateforward.core.CompositeState" href="../../Core/Elements/#stateforward.core.elements.CompositeState">CompositeState</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The composite state to be preprocessed, expected to be an instance of 'core.CompositeState'.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>None</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This method modifies the composite state element in-place and has no return value.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_composite_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.CompositeState&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Processes a composite state to organize its sub-elements such as transitions, vertices, and regions.</span>
<span class="sd">    This method takes an element that is assumed to be a composite state, and iterates over its owned elements</span>
<span class="sd">    to categorize them into transitions, subvertices, and regions. If there are subvertices without an enclosing region,</span>
<span class="sd">    a new region is created to contain them along with any associated transitions. Existing regions within the composite state</span>
<span class="sd">    are preserved. The method then ensures that all transitions and subvertices are assigned to a region, either the new region</span>
<span class="sd">    or one of the existing ones, by updating their &#39;container&#39; attributes. If an owned element corresponds to an attribute of</span>
<span class="sd">    the composite state, that association is maintained within the newly formed or existing region.</span>

<span class="sd">    Args:</span>
<span class="sd">        element (type[&#39;core.CompositeState&#39;]):</span>
<span class="sd">             The composite state to be preprocessed, expected to be an instance of &#39;core.CompositeState&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None:</span>
<span class="sd">             This method modifies the composite state element in-place and has no return value.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">transitions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">subvertex</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">regions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">owned_element</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="n">_owned_element</span>
        <span class="k">for</span> <span class="n">_owned_element</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">owned_elements_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">model</span><span class="o">.</span><span class="n">is_descendant_of</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">_owned_element</span><span class="p">)</span> <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span>
        <span class="p">)</span>
    <span class="p">]:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">owned_element</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Transition</span><span class="p">):</span>
            <span class="n">transitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">owned_element</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_type</span><span class="p">(</span><span class="n">owned_element</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">Collection</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
            <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">_child</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Transition</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_child</span> <span class="ow">in</span> <span class="n">owned_element</span>
        <span class="p">):</span>
            <span class="n">transitions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">owned_element</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">owned_element</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Vertex</span><span class="p">):</span>
            <span class="n">subvertex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">owned_element</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">owned_element</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Region</span><span class="p">):</span>
            <span class="n">regions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">owned_element</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">subvertex</span><span class="p">:</span>
        <span class="n">new_region</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;region_</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">bases</span><span class="o">=</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">Region</span><span class="p">,),</span>
        <span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
            <span class="n">element</span><span class="p">,</span>
            <span class="s2">&quot;regions&quot;</span><span class="p">,</span>
            <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="n">new_region</span><span class="p">,</span> <span class="o">*</span><span class="n">regions</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">owned_element</span> <span class="ow">in</span> <span class="n">subvertex</span> <span class="o">+</span> <span class="n">transitions</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">owner_of_owned_element</span> <span class="o">:=</span> <span class="n">model</span><span class="o">.</span><span class="n">owner_of</span><span class="p">(</span><span class="n">owned_element</span><span class="p">)</span>
            <span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">owned_element</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">remove_owned_element_from</span><span class="p">(</span>
                    <span class="n">owner_of_owned_element</span><span class="p">,</span> <span class="n">owned_element</span>
                <span class="p">)</span>
                <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">owned_element</span><span class="p">,</span> <span class="s2">&quot;container&quot;</span><span class="p">,</span> <span class="n">new_region</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">owned_element_name</span> <span class="o">:=</span> <span class="n">model</span><span class="o">.</span><span class="n">name_of</span><span class="p">(</span><span class="n">owned_element</span><span class="p">)</span>
            <span class="p">)</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">attributes_of</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
                <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">new_region</span><span class="p">,</span> <span class="n">owned_element_name</span><span class="p">,</span> <span class="n">owned_element</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">model</span><span class="o">.</span><span class="n">add_owned_element_to</span><span class="p">(</span><span class="n">new_region</span><span class="p">,</span> <span class="n">owned_element</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">regions</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;regions&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="o">*</span><span class="n">regions</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_final_state" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_final_state</span><span class="p">(</span><span class="n">element</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Processes a final state element within the state machine before compilation.
This method is responsible for applying preprocessing steps to the given final state element
within the context of the state machine. It is designed to be overridden in subclasses for
specific behaviors. The default implementation delegates the preprocessing to the
<code>preprocess_vertex</code> method.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>element</code></td>
          <td>
                <code>type[<a class="autorefs autorefs-internal" title="stateforward.core.FinalState" href="../../Core/Elements/#stateforward.core.elements.FinalState">FinalState</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The final state element of the state machine to preprocess.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:</p>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_final_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.FinalState&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Processes a final state element within the state machine before compilation.</span>
<span class="sd">    This method is responsible for applying preprocessing steps to the given final state element</span>
<span class="sd">    within the context of the state machine. It is designed to be overridden in subclasses for</span>
<span class="sd">    specific behaviors. The default implementation delegates the preprocessing to the</span>
<span class="sd">    `preprocess_vertex` method.</span>

<span class="sd">    Args:</span>
<span class="sd">        element (type[&#39;core.FinalState&#39;]):</span>
<span class="sd">             The final state element of the state machine to preprocess.</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_vertex</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_processor" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_processor</span><span class="p">(</span><span class="n">element</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Preprocesses an interpreter element to set up queue characteristics based on concurrency type.
This method examines the concurrency_kind attribute of the provided interpreter element and sets an attribute to use an asynchronous queue if the concurrency kind matches asynchronous operation.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>element</code></td>
          <td>
                <code>type[<span title="stateforward.model.Interpreter">Interpreter</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The interpreter element to preprocess, it must be an instance or subclass of model.Interpreter. The element is expected to have a model property with a concurrency_kind attribute.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>AttributeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the 'model' property or 'concurrency_kind' attribute is missing from the element.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;model.Interpreter&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Preprocesses an interpreter element to set up queue characteristics based on concurrency type.</span>
<span class="sd">    This method examines the concurrency_kind attribute of the provided interpreter element and sets an attribute to use an asynchronous queue if the concurrency kind matches asynchronous operation.</span>

<span class="sd">    Args:</span>
<span class="sd">        element (type[&#39;model.Interpreter&#39;]):</span>
<span class="sd">             The interpreter element to preprocess, it must be an instance or subclass of model.Interpreter. The element is expected to have a model property with a concurrency_kind attribute.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AttributeError:</span>
<span class="sd">             If the &#39;model&#39; property or &#39;concurrency_kind&#39; attribute is missing from the element.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">concurrency_kind</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">concurrency_kind</span>
    <span class="k">if</span> <span class="n">concurrency_kind</span> <span class="o">==</span> <span class="n">core</span><span class="o">.</span><span class="n">ConcurrencyKind</span><span class="o">.</span><span class="n">asynchronous</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;queue&quot;</span><span class="p">,</span> <span class="n">AsyncQueue</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_region" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_region</span><span class="p">(</span><span class="n">element</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Processes the given UML region by setting attributes and filtering sub-elements.
This method takes an element of type 'core.Region' and performs preprocessing to set attributes
related to its subvertices, initial state, parent state, and parent state machine. It identifies
all the subvertices of the region that are of type 'core.Vertex' and sets the 'subvertex' attribute.
If the region does not have an explicit initial state, this method will attempt to find one based on
the provided filtering criteria. Once an initial state is identified or confirmed, the method sets
the 'initial' attribute of the element.
The method also discerns and sets attributes for the region's parent state and state machine,
ensuring that each is appropriately classified as either a 'core.State' or 'StateMachine'.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>element</code></td>
          <td>
                <code>type[<a class="autorefs autorefs-internal" title="stateforward.core.Region" href="../../Core/Elements/#stateforward.core.elements.Region">Region</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The region of a state machine to preprocess.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>AttributeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the attributes related to 'subvertex', 'initial', 'state', or
'state_machine' cannot be set due to incorrect typing or hierarchy of the provided element.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:</p>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Region&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Processes the given UML region by setting attributes and filtering sub-elements.</span>
<span class="sd">    This method takes an element of type &#39;core.Region&#39; and performs preprocessing to set attributes</span>
<span class="sd">    related to its subvertices, initial state, parent state, and parent state machine. It identifies</span>
<span class="sd">    all the subvertices of the region that are of type &#39;core.Vertex&#39; and sets the &#39;subvertex&#39; attribute.</span>
<span class="sd">    If the region does not have an explicit initial state, this method will attempt to find one based on</span>
<span class="sd">    the provided filtering criteria. Once an initial state is identified or confirmed, the method sets</span>
<span class="sd">    the &#39;initial&#39; attribute of the element.</span>
<span class="sd">    The method also discerns and sets attributes for the region&#39;s parent state and state machine,</span>
<span class="sd">    ensuring that each is appropriately classified as either a &#39;core.State&#39; or &#39;StateMachine&#39;.</span>

<span class="sd">    Args:</span>
<span class="sd">        element (type[&#39;core.Region&#39;]):</span>
<span class="sd">             The region of a state machine to preprocess.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AttributeError:</span>
<span class="sd">             If the attributes related to &#39;subvertex&#39;, &#39;initial&#39;, &#39;state&#39;, or</span>
<span class="sd">            &#39;state_machine&#39; cannot be set due to incorrect typing or hierarchy of the provided element.</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">stateforward.core</span> <span class="kn">import</span> <span class="n">StateMachine</span>

    <span class="k">def</span> <span class="nf">initial_filter</span><span class="p">(</span><span class="n">vertex</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines whether a given vertex is a subtype of core.Initial.</span>

<span class="sd">        Args:</span>
<span class="sd">            vertex (Any):</span>
<span class="sd">                 The vertex to be checked for being a subtype.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool:</span>
<span class="sd">                 True if the vertex is a subtype of core.Initial, otherwise False.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">vertex</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Initial</span><span class="p">)</span>

    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
        <span class="n">element</span><span class="p">,</span>
        <span class="s2">&quot;subvertex&quot;</span><span class="p">,</span>
        <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span>
            <span class="o">*</span><span class="n">model</span><span class="o">.</span><span class="n">find_owned_elements_of</span><span class="p">(</span>
                <span class="n">element</span><span class="p">,</span>
                <span class="k">lambda</span> <span class="n">owned_element</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span>
                    <span class="n">owned_element</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Vertex</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">initial</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;initial&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">initial</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">initial</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">find_owned_element_of</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">initial_filter</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;initial&quot;</span><span class="p">,</span> <span class="n">initial</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;region </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2"> has initial </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">initial</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">owner_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="p">(</span><span class="n">StateMachine</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">State</span><span class="p">)):</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">owner_of</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
        <span class="n">element</span><span class="p">,</span>
        <span class="s2">&quot;state&quot;</span><span class="p">,</span>
        <span class="n">parent</span> <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">State</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
        <span class="n">element</span><span class="p">,</span>
        <span class="s2">&quot;state_machine&quot;</span><span class="p">,</span>
        <span class="n">parent</span> <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">StateMachine</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_state" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_state</span><span class="p">(</span><span class="n">element</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Preprocesses a state in the state machine for further operations.
This method takes a state as an argument and performs preprocessing step depending on whether it is a composite state or contains a submachine. If the state has a submachine, it gets logged. Additionally, it handles the preprocessing for the vertices of the state and ensures that 'entry', 'exit', and 'activity' behaviors are set on the state if they are not already defined.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>element</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="stateforward.core.State" href="../../Core/Elements/#stateforward.core.elements.State">State</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state to preprocess. This type should be derived from a class that has an attribute 'submachine', which indicates whether the state is a simple state or a composite state with its own submachine.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:</p>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.State&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Preprocesses a state in the state machine for further operations.</span>
<span class="sd">    This method takes a state as an argument and performs preprocessing step depending on whether it is a composite state or contains a submachine. If the state has a submachine, it gets logged. Additionally, it handles the preprocessing for the vertices of the state and ensures that &#39;entry&#39;, &#39;exit&#39;, and &#39;activity&#39; behaviors are set on the state if they are not already defined.</span>

<span class="sd">    Args:</span>
<span class="sd">        element (core.State):</span>
<span class="sd">             The state to preprocess. This type should be derived from a class that has an attribute &#39;submachine&#39;, which indicates whether the state is a simple state or a composite state with its own submachine.</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">submachine</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_composite_state</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;preprocessing submachine </span><span class="si">{</span><span class="n">element</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;entry&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">None</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="c1"># for region in element.submachine.regions.core():</span>
        <span class="c1">#     model.set_attribute(region, &quot;state&quot;, element)</span>
        <span class="c1">#     model.set_attribute(region, &quot;state_machine&quot;, None)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_vertex</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">behavior</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;entry&quot;</span><span class="p">,</span> <span class="s2">&quot;exit&quot;</span><span class="p">,</span> <span class="s2">&quot;activity&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">behavior</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
                <span class="n">element</span><span class="p">,</span>
                <span class="n">behavior</span><span class="p">,</span>
                <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">behavior</span><span class="p">,</span> <span class="n">bases</span><span class="o">=</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">Behavior</span><span class="p">,)),</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_state_machine" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_state_machine</span><span class="p">(</span><span class="n">element</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Preprocesses a state machine behavior object prior to compilation.
This method takes an element which is an instance of a specific state machine behavior and performs preprocessing steps on it. These steps involve preprocessing any composite states within the element and the behavior itself. This is essential to prepare the element for subsequent compilation or transformation processes. It involves logging the preprocessing step, ensuring internal consistency, setting up necessary ordering, and potentially more based on the implementation details.
The function concludes by sorting a collection within the state machine. The sorting criteria is based on the type of event; it prioritizes non-completion events over completion events. This ordering may affect how events are processed or triggered within the state machine behavior at runtime.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>element</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="stateforward.core.Behavior" href="../../Core/Elements/#stateforward.core.elements.Behavior">Behavior</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state machine behavior to preprocess. This is expected to be a subtype of 'core.Behavior'.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>None</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This method performs operations on the 'element' object but does not return any value.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_state_machine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Behavior&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Preprocesses a state machine behavior object prior to compilation.</span>
<span class="sd">    This method takes an element which is an instance of a specific state machine behavior and performs preprocessing steps on it. These steps involve preprocessing any composite states within the element and the behavior itself. This is essential to prepare the element for subsequent compilation or transformation processes. It involves logging the preprocessing step, ensuring internal consistency, setting up necessary ordering, and potentially more based on the implementation details.</span>
<span class="sd">    The function concludes by sorting a collection within the state machine. The sorting criteria is based on the type of event; it prioritizes non-completion events over completion events. This ordering may affect how events are processed or triggered within the state machine behavior at runtime.</span>

<span class="sd">    Args:</span>
<span class="sd">        element (core.Behavior):</span>
<span class="sd">             The state machine behavior to preprocess. This is expected to be a subtype of &#39;core.Behavior&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None:</span>
<span class="sd">             This method performs operations on the &#39;element&#39; object but does not return any value.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;preprocessing state machine </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">submachine_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_state</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">submachine_state</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_composite_state</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_behavior</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">sort_collection</span><span class="p">(</span>
        <span class="n">element</span><span class="o">.</span><span class="n">pool</span><span class="p">,</span>
        <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="ow">not</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">CompletionEvent</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_transition" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_transition</span><span class="p">(</span><span class="n">element</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Preprocesses the transition element to ensure it has all the necessary attributes set up correctly.
This method processes a given transition element by setting up default values and verifying its
correctness within a state machine. It checks if the transition source is defined, and if not,
it attempts to derive the source based on hierarchy and ownership rules. It handles the completion
events for states, initializes an empty effect if none is provided, and determines the transition
kind based on the relationship between the source and target.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>element</code></td>
          <td>
                <code>type[<a class="autorefs autorefs-internal" title="stateforward.core.Transition" href="../../Core/Elements/#stateforward.core.elements.Transition">Transition</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The transition element to preprocess.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the transition source is not found or if the transition has no container.
This function does not return any value but modifies the transition element in place.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Transition&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Preprocesses the transition element to ensure it has all the necessary attributes set up correctly.</span>
<span class="sd">    This method processes a given transition element by setting up default values and verifying its</span>
<span class="sd">    correctness within a state machine. It checks if the transition source is defined, and if not,</span>
<span class="sd">    it attempts to derive the source based on hierarchy and ownership rules. It handles the completion</span>
<span class="sd">    events for states, initializes an empty effect if none is provided, and determines the transition</span>
<span class="sd">    kind based on the relationship between the source and target.</span>

<span class="sd">    Args:</span>
<span class="sd">        element (type[&#39;core.Transition&#39;]):</span>
<span class="sd">             The transition element to preprocess.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError:</span>
<span class="sd">             If the transition source is not found or if the transition has no container.</span>
<span class="sd">            This function does not return any value but modifies the transition element in place.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">source</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">owner</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">owner_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">Collection</span><span class="p">):</span>
            <span class="n">owner</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">owner_of</span><span class="p">(</span><span class="n">owner</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Vertex</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;transition </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2"> has no source and is not owned by a state&quot;</span>
            <span class="p">)</span>
        <span class="c1"># transition source always defaults to the parent</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="n">owner</span><span class="p">)</span>

    <span class="c1"># yield from self.wait_for_completion_of(element.source)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_element</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">events</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">State</span><span class="p">):</span>
            <span class="n">completion</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">completion</span>
            <span class="k">if</span> <span class="n">completion</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">completion</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
                    <span class="s2">&quot;completion&quot;</span><span class="p">,</span>
                    <span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">CompletionEvent</span><span class="p">,),</span>
                <span class="p">)</span>
                <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="s2">&quot;completion&quot;</span><span class="p">,</span> <span class="n">completion</span><span class="p">)</span>

            <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
                <span class="n">element</span><span class="p">,</span>
                <span class="s2">&quot;events&quot;</span><span class="p">,</span>
                <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span>
                    <span class="n">completion</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">effect</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span>
            <span class="n">element</span><span class="p">,</span>
            <span class="s2">&quot;effect&quot;</span><span class="p">,</span>
            <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
                <span class="s2">&quot;effect&quot;</span><span class="p">,</span>
                <span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">Behavior</span><span class="p">,),</span>
                <span class="n">activity</span><span class="o">=</span><span class="n">no_async_activity</span>
                <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="n">concurrency_kind</span>
                <span class="ow">is</span> <span class="n">core</span><span class="o">.</span><span class="n">ConcurrencyKind</span><span class="o">.</span><span class="n">asynchronous</span>
                <span class="k">else</span> <span class="n">no_activity</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>
    <span class="n">container</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">container</span>
    <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="n">element</span><span class="o">.</span><span class="n">target</span><span class="p">:</span>
        <span class="n">element</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">self</span>
    <span class="k">elif</span> <span class="n">element</span><span class="o">.</span><span class="n">target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">element</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">internal</span>
    <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">is_descendant_of</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">target</span><span class="p">):</span>
        <span class="n">element</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">local</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_element</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
        <span class="n">element</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">TransitionKind</span><span class="o">.</span><span class="n">external</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">least_common_ancestor</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">container</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;transition </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2"> has no container&quot;</span>
        <span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;container&quot;</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_transition_path</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="stateforward.state_machine.preprocessor.StateMachinePreprocessor.preprocess_vertex" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_vertex</span><span class="p">(</span><span class="n">element</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Processes the given vertex by assigning it a container and categorizing its incoming and outgoing transitions.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>element</code></td>
          <td>
                <code>type[<a class="autorefs autorefs-internal" title="stateforward.core.Vertex" href="../../Core/Elements/#stateforward.core.elements.Vertex">Vertex</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The vertex element to preprocess. This vertex should be part of a state machine model.
The function logs the process of finding the container for the given vertex. If no container is found, an error is logged.
Furthermore, the function identifies and categorizes all outgoing and incoming transitions of the vertex. It checks for transitions that are either originating from or targeting the element. It updates the 'outgoing' and 'incoming' attributes of the element with the newly found transitions.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Vertex&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Processes the given vertex by assigning it a container and categorizing its incoming and outgoing transitions.</span>

<span class="sd">    Args:</span>
<span class="sd">        element (type[&#39;core.Vertex&#39;]):</span>
<span class="sd">             The vertex element to preprocess. This vertex should be part of a state machine model.</span>
<span class="sd">            The function logs the process of finding the container for the given vertex. If no container is found, an error is logged.</span>
<span class="sd">            Furthermore, the function identifies and categorizes all outgoing and incoming transitions of the vertex. It checks for transitions that are either originating from or targeting the element. It updates the &#39;outgoing&#39; and &#39;incoming&#39; attributes of the element with the newly found transitions.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">create_logger</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;preprocess_vertex(</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;finding container for </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">container</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">find_ancestor_of</span><span class="p">(</span>
        <span class="n">element</span><span class="p">,</span>
        <span class="k">lambda</span> <span class="n">owned_element</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span><span class="n">owned_element</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Region</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">container</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;vertex </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="si">}</span><span class="s2"> has no container&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;found container </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">qualified_name_of</span><span class="p">(</span><span class="n">container</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;container&quot;</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>

    <span class="n">outgoing</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">outgoing</span><span class="p">)</span> <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">outgoing</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">incoming</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">incoming</span><span class="p">)</span> <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">incoming</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">transition</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">find_descendants_of</span><span class="p">(</span>
        <span class="n">model</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">element</span><span class="p">),</span>
        <span class="k">lambda</span> <span class="n">owned_element</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">is_subtype</span><span class="p">(</span>
            <span class="n">owned_element</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">Transition</span>
        <span class="p">),</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">transition</span><span class="o">.</span><span class="n">source</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">owner_of</span><span class="p">(</span><span class="n">transition</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">==</span> <span class="n">element</span> <span class="ow">and</span> <span class="n">transition</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">outgoing</span><span class="p">:</span>
            <span class="n">outgoing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">transition</span><span class="o">.</span><span class="n">target</span> <span class="o">==</span> <span class="n">element</span> <span class="ow">and</span> <span class="n">transition</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">incoming</span><span class="p">:</span>
            <span class="n">incoming</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;outgoing&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="o">*</span><span class="n">outgoing</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s2">&quot;incoming&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="o">*</span><span class="n">incoming</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h3 id="stateforward.state_machine.preprocessor.least_common_ancestor" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">least_common_ancestor</span><span class="p">(</span><span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Finds the least common ancestor between two vertices in a state machine graph.
This function computes the least common ancestor (LCA) between two given vertices (node1 and node2). It operates under the assumption that each vertex has a container that can also be considered a vertex, and that the structure forms a hierarchical state machine. The LCA is defined as the lowest vertex at which the two input vertices are both descendants.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>node1</code></td>
          <td>
                <code>type[<a class="autorefs autorefs-internal" title="stateforward.core.Vertex" href="../../Core/Elements/#stateforward.core.elements.Vertex">Vertex</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The first vertex for which to find the LCA.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>node2</code></td>
          <td>
                <code>type[<a class="autorefs autorefs-internal" title="stateforward.core.Vertex" href="../../Core/Elements/#stateforward.core.elements.Vertex">Vertex</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The second vertex for which to find the LCA.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>type['core.Vertex']:
 The least common ancestor of the two given vertices. Returns the container itself if one vertex is a descendant of another, or if the container of the first node doesn't have a state, indicating the top of the hierarchy.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Raises:</p>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">least_common_ancestor</span><span class="p">(</span><span class="n">node1</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Vertex&quot;</span><span class="p">],</span> <span class="n">node2</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;core.Vertex&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the least common ancestor between two vertices in a state machine graph.</span>
<span class="sd">    This function computes the least common ancestor (LCA) between two given vertices (node1 and node2). It operates under the assumption that each vertex has a container that can also be considered a vertex, and that the structure forms a hierarchical state machine. The LCA is defined as the lowest vertex at which the two input vertices are both descendants.</span>

<span class="sd">    Args:</span>
<span class="sd">        node1 (type[&#39;core.Vertex&#39;]):</span>
<span class="sd">             The first vertex for which to find the LCA.</span>
<span class="sd">        node2 (type[&#39;core.Vertex&#39;]):</span>
<span class="sd">             The second vertex for which to find the LCA.</span>

<span class="sd">    Returns:</span>
<span class="sd">        type[&#39;core.Vertex&#39;]:</span>
<span class="sd">             The least common ancestor of the two given vertices. Returns the container itself if one vertex is a descendant of another, or if the container of the first node doesn&#39;t have a state, indicating the top of the hierarchy.</span>

<span class="sd">    Raises:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">is_descendant_of</span><span class="p">(</span><span class="n">node1</span><span class="o">.</span><span class="n">container</span><span class="p">,</span> <span class="n">node2</span><span class="p">):</span>
        <span class="n">lca</span> <span class="o">=</span> <span class="n">node1</span><span class="o">.</span><span class="n">container</span>
    <span class="k">elif</span> <span class="n">model</span><span class="o">.</span><span class="n">is_descendant_of</span><span class="p">(</span><span class="n">node2</span><span class="o">.</span><span class="n">container</span><span class="p">,</span> <span class="n">node1</span><span class="p">):</span>
        <span class="n">lca</span> <span class="o">=</span> <span class="n">node2</span><span class="o">.</span><span class="n">container</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">node1</span><span class="o">.</span><span class="n">container</span>
        <span class="k">if</span> <span class="n">container</span><span class="o">.</span><span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">container</span>
        <span class="n">lca</span> <span class="o">=</span> <span class="n">least_common_ancestor</span><span class="p">(</span><span class="n">container</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="n">node2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lca</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="stateforward.state_machine.preprocessor.no_activity" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">no_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Handles a situation where there is no activity for a given event.
This method is a placeholder intended to be overridden by subclasses to define
specific behavior when an event has no activity. By default, it does nothing.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>event</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="stateforward.core.Event" href="../../Core/Elements/#stateforward.core.elements.Event">Event</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The event object that has no activity.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">no_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="s2">&quot;core.Event&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles a situation where there is no activity for a given event.</span>
<span class="sd">    This method is a placeholder intended to be overridden by subclasses to define</span>
<span class="sd">    specific behavior when an event has no activity. By default, it does nothing.</span>

<span class="sd">    Args:</span>
<span class="sd">        event (core.Event):</span>
<span class="sd">             The event object that has no activity.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="stateforward.state_machine.preprocessor.no_async_activity" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">no_async_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Coroutines defined with async def syntax are meant to be invoked in an asynchronous event loop. However, "no_async_activity" is designated as a stub with a pass statement, which means it currently does not perform any action when awaited on an event. The presence of an event parameter of hypothetical type 'core.Event' implies that it may potentially handle an event object from some core library or framework in the future.</p>

          <details class="quote">
            <summary>Source code in <code>stateforward/state_machine/preprocessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">no_async_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="s2">&quot;core.Event&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Coroutines defined with async def syntax are meant to be invoked in an asynchronous event loop. However, &quot;no_async_activity&quot; is designated as a stub with a pass statement, which means it currently does not perform any action when awaited on an event. The presence of an event parameter of hypothetical type &#39;core.Event&#39; implies that it may potentially handle an event object from some core library or framework in the future.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.top", "navigation.indexes", "navigation.expand", "search.highlight", "search.suggest", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.81fa17fe.min.js"></script>
      
    
  </body>
</html>